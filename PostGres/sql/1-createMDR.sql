DROP Table if exists TECHPACK_VERSIONS;
DROP Table if exists SUPPORTED_NODE_VERSIONS;
DROP Table if exists NODE_MANAGED_OBJECTS;
DROP Table if exists NODE_MANAGED_OBJECTS_HIERARCHY;
DROP Table if exists REPORTABLE_ENTITY;
DROP Table if exists REPORTABLE_ENTITY_COLUMNS;

CREATE Table TECHPACK_VERSIONS
(
	TECHPACK_VERSION_ID varchar(128),
	TECHPACK_NAME varchar(128),
	TECHPACK_RELEASE varchar(128),
	TECHPACK_VERSION varchar(128),
	PRODUCT_NUMBER varchar(128),
	FEATURE_NAME varchar(128),
	DESCRIPTION varchar(255),
	LICENSE varchar(128),
	DEPENDENCY varchar(128)  
);

CREATE Table SUPPORTED_NODE_VERSIONS
(
	TECHPACK_VERSION_ID varchar(128),
	NODE_MODEL_VERSION_ID varchar(128),
	MODEL_NAME varchar(128),
	MODEL_VERSION varchar(128),
	NODE_VERSION  varchar(128),
	DESCRIPTION varchar(255)
);

CREATE Table NODE_MANAGED_OBJECTS
(
	TECHPACK_VERSION_ID varchar(128),
	NODE_MODEL_VERSION_ID varchar(128),
	MO_NAME varchar(128),
	MO_DESCRIPTION varchar(255)
);

CREATE Table NODE_MANAGED_OBJECTS_HIERARCHY
(
	TECHPACK_VERSION_ID varchar(128),
	NODE_MODEL_VERSION_ID varchar(128),
	PARENT_MO_NAME varchar(128),
	CHILD_MO_NAME varchar(128)
);

CREATE Table REPORTABLE_ENTITY
(
	TECHPACK_VERSION_ID varchar(128),
	REPORTABLE_ENTITY_NAME varchar(128),
	REPORTABLE_ENTITY_DESCRIPTION varchar(255),
	DERIVED_FROM varchar(128)
);

CREATE Table REPORTABLE_ENTITY_COLUMNS
(
	TECHPACK_VERSION_ID varchar(128),
	REPORTABLE_ENTITY_ID varchar(128),
	PERSISTENCE_ENTITY_ID varchar(128),
	COLUMN_NAME varchar(128),
	COLUMN_TYPE varchar(128),
	COLUMN_DESCRIPTION varchar(255),
	PERSISTENCE_ENTITY_COLUMN_NAME varchar(128)
);


DROP Table if exists PERSISTENCE_ENTITY;
DROP Table if exists PERSISTENCE_ENTITY_COLUMNS;
DROP Table if exists FLOW_CONFIGURATION;
DROP Table if exists FLOW_SCHEDULING;
DROP Table if exists FILEBACKLOG;

CREATE Table PERSISTENCE_ENTITY
(
	TECHPACK_VERSION_ID varchar(128),
	NODE_MODEL_VERSION_ID varchar(128),
	PERSISTENCE_ENTITY_ID varchar(128),
	PERSISTENCE_ENTITY_NAME varchar(128),
	DERIVED_FROM varchar(128),
	DERIVE_TYPE varchar(128)
);

CREATE Table PERSISTENCE_ENTITY_COLUMNS
(
	TECHPACK_VERSION_ID varchar(128),
	NODE_MODEL_VERSION_ID varchar(128),
	PERSISTENCE_ENTITY_ID varchar(128),
	COLUMN_ORDER varchar(128),
	COLUMN_NAME varchar(128),
	COLUMN_TYPE varchar(128),
	COLUMN_DESCRIPTION varchar(255),
	PARTITION_BY SMALLINT,
	MO_NAME  varchar(128),
	MO_ATTRIBUTE_NAME varchar(128)
);

CREATE Table FLOW_CONFIGURATION
(
	TECHPACK_VERSION_ID varchar(128),
	FLOW_NAME varchar(128),
	WORKER_NAME varchar(128),
	WORKER_CONFIG varchar(128),
	DEPENDENCY_FLOW_NAME varchar(128),
	DEPENDENCY_WORKER_NAME varchar(128)
);

CREATE Table FLOW_SCHEDULING
(
	TECHPACK_VERSION_ID varchar(128),
	FLOW_NAME varchar(128),
	WORKER_NAME varchar(128),
	REOCCURING varchar(128),
	ROP_INTERVAL int,
	ROP_OFFSET int
);

CREATE Table FILEBACKLOG
(
	TECHPACK_VERSION_ID varchar(128),
	FLOW_NAME varchar(128),
	WORKER_NAME varchar(128),
	FILELIST TEXT []
);


